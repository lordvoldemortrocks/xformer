<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <base data-ice="baseUrl" href="../../">
  <title data-ice="title">src/palette.js | xFormer</title>
  <link type="text/css" rel="stylesheet" href="css/style.css">
  <link type="text/css" rel="stylesheet" href="css/prettify-tomorrow.css">
  <script src="script/prettify/prettify.js"></script>
  <script src="script/manual.js"></script>
<meta name="description" content="xFormer makes data transformations easy on your cognition and hassle-free."><meta property="og:type" content="website"><meta property="og:url" content="https://www.npmjs.com/package/@muhammadkasim/xformer"><meta property="og:site_name" content="xFormer"><meta property="og:title" content="xFormer"><meta property="og:image" content="./logo.png"><meta property="og:description" content="xFormer makes data transformations easy on your cognition and hassle-free."><meta property="og:author" content="Muhammad Kasim"><meta property="twitter:card" content="summary"><meta property="twitter:title" content="xFormer"><meta property="twitter:description" content="xFormer makes data transformations easy on your cognition and hassle-free."><meta property="twitter:image" content="./logo.png"></head>
<body class="layout-container" data-ice="rootContainer">

<header>
  <a href="./" style="display: flex; align-items: center;"><img src="./image/brand_logo.png" style="width:34px;"></a>
  
  <a href="identifiers.html">Reference</a>
  <a href="source.html">Source</a>
  <a href="test.html" data-ice="testLink">Test</a>
  <div class="search-box">
  <span>
    <img src="./image/search.png">
    <span class="search-input-edge"></span><input class="search-input"><span class="search-input-edge"></span>
  </span>
    <ul class="search-result"></ul>
  </div>
<a href="https://gitlab.com/muhammadkasim/xformer">Repository</a></header>

<nav class="navigation" data-ice="nav"><div>
  <ul>
    
  <li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-getContext">getContext</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-setContext">setContext</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-_">_</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-absolute">absolute</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-add">add</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-all">all</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-allPass">allPass</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-any">any</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-anyPass">anyPass</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-cleanData">cleanData</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-cleanDataByKeys">cleanDataByKeys</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-defaultAll">defaultAll</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-differential">differential</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-divide">divide</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-getAvg">getAvg</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-getMax">getMax</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-getRate">getRate</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-getUsedMemory">getUsedMemory</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-identity">identity</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-isEqualTo">isEqualTo</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-isGreaterThan">isGreaterThan</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-isGreaterThanEqualTo">isGreaterThanEqualTo</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-isLessThan">isLessThan</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-isLessThanEqualTo">isLessThanEqualTo</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-isNothing">isNothing</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-makePair">makePair</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-map">map</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-max">max</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-mergeAll">mergeAll</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-mergeWithAdd">mergeWithAdd</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-mergeWithMax">mergeWithMax</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-mergeWithMin">mergeWithMin</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-mergeWithOp">mergeWithOp</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-mergeWithSubtract">mergeWithSubtract</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-min">min</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-multiply">multiply</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-pickByRegex">pickByRegex</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-pickFrom">pickFrom</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-runAll">runAll</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-sortAscending">sortAscending</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-sortDescending">sortDescending</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-subtract">subtract</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-sumAll">sumAll</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-takeTopAndCombineOthers">takeTopAndCombineOthers</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-takeTopPairsAndAddOthers">takeTopPairsAndAddOthers</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-testRegex">testRegex</a></span></span></li>
</ul>
</div>
</nav>

<div class="content" data-ice="content"><h1 data-ice="title">src/palette.js</h1>
<pre class="source-code line-number raw-source-code"><code class="prettyprint linenums" data-ice="content">/*
  This file contains the xFormer functions; the end user will build queries using these functions.
	This is the command pallete.
*/

import * as R from &apos;ramda&apos;;
import * as E from &apos;./executor&apos;;
import * as D from &apos;./decoder&apos;;
import * as H from &apos;./helpers&apos;;

/**
 * A special placeholder value used to specify &quot;gaps&quot; within functions, allowing partial application of any combination of arguments.
 *
 * @example
 *        fn(1, 2, 3)
 *        fn(_, 2, 3)(1)
 *        fn(1, _, 3)(2)
 *        fn(_, 2, _)(1, 3)
 *        fn(_, 2, _)(1)(3)
 */
export const _ = R.__;

/**
 * Returns true if the value under test is empty or nil.
 *
 * @param  {any} value
 * @returns {boolean}
 * @example
 *        isNothing(undefined) //=&gt; true
 *        isNothing(null) //=&gt; true
 *        isNothing([]) //=&gt; true
 *        isNothing(&apos;&apos;) //=&gt; true
 *        isNothing({}) //=&gt; true
 *        isNothing(&apos;Hello, world!&apos;) //=&gt; false
 */
export const isNothing = H.isNothing;

/**
 * Returns true if the 2 provided values are deeply equal.
 *
 * @param  {any} l
 * @param  {any} r
 * @returns {boolean}
 * @example
 *        isEqualTo(&apos;Batman&apos;, &apos;Bruce Wayne&apos;) //=&gt; false
 *        isEqualTo([1], [1]) //=&gt; true
 */
export const isEqualTo = R.memoizeWith((x, y) =&gt; R.toString([x, y]), R.equals);
/**
 * Returns booleon based upon provided regex.
 *
 * @param  {any} value
 * @returns {boolean}
 * @example
 *        testRegex(&apos;Batman&apos;, &apos;Bruce Wayne&apos;) //=&gt; false
 *        testRegex(/Batman/i, &apos;batman Wayne&apos;) //=&gt; true
 */
export const testRegex = R.curry((text, value) =&gt; R.test(new RegExp(text), value));

/**
 * Returns true if the second value is less than the first value.
 *
 * @param  {any} value
 * @returns {boolean}
 * @example
 *        isLessThan(0, -2) //=&gt; true
 *        isLessThan(-4, -2) //=&gt; false
 */
export const isLessThan = R.flip(R.lt);

/**
 * Returns true if the second value is greater than the first value.
 *
 * @param  {any} value
 * @returns {boolean}
 * @example
 *        isGreaterThan(0, -2) //=&gt; false
 *        isGreaterThan(-4, -2) //=&gt; true
 */
export const isGreaterThan = R.flip(R.gt);

/**
 * Returns true if the second value is less than or equal to the first value.
 *
 * @param  {any} value
 * @returns {boolean}
 * @example
 *        isLessThanEqualTo(0, -2) //=&gt; true
 *        isLessThanEqualTo(-4, -2) //=&gt; false
 */
export const isLessThanEqualTo = R.flip(R.lte);

/**
 * Returns true if the second value is greater than or equal to the first value.
 *
 * @param  {any} value
 * @returns {boolean}
 * @example
 *        isGreaterThanEqualTo(0, -2) //=&gt; false
 *        isGreaterThanEqualTo(-4, -2) //=&gt; true
 */
export const isGreaterThanEqualTo = R.flip(R.gte);

/**
 * A function that returns the same value it was passed.
 */
export const identity = R.identity;

/**
 * @param  {number} left
 * @param  {number} right
 * @returns {number}
 * @example
 *         add(2, 2) //=&gt; 4
 *         add(2, &apos;2&apos;) //=&gt; 4
 *         add(2, null) //=&gt; 2
 *         add(undefined, null) //=&gt; 0
 */
export const add = H.add;

/**
 * @param  {number} left
 * @param  {number} right
 * @returns {number}
 * @example
 *         subtract(4, 2) //=&gt; 2
 *         subtract(4, &apos;2&apos;) //=&gt; 2
 *         subtract(4, null) //=&gt; 4
 *         subtract(undefined, null) //=&gt; 0
 */
export const subtract = H.subtract;

/**
 * @param  {number} left
 * @param  {number} right
 * @returns {number}
 * @example
 *         multiply(4, 2) //=&gt; 8
 *         multiply(4, &apos;2&apos;) //=&gt; 8
 *         multiply(4, null) //=&gt; 0
 *         multiply(undefined, null) //=&gt; 0
 */
export const multiply = H.multiply;

/**
 * @param  {number} left
 * @param  {number} right
 * @returns {number}
 * @example
 *         divide(4, 2) //=&gt; 2
 *         divide(4, &apos;2&apos;) //=&gt; 2
 *         divide(4, null) //=&gt; 4
 *         divide(undefined, null) //=&gt; 0
 */
export const divide = H.divide;

/**
 * @param  {number} left
 * @param  {number} right
 * @returns {number}
 * @example
 *         max(4, 2) //=&gt; 4
 *         max(4, &apos;2&apos;) //=&gt; 4
 *         max(4, null) //=&gt; 4
 *         max(undefined, null) //=&gt; 0
 */
export const max = H.max;

/**
 * @param  {number} left
 * @param  {number} right
 * @returns {number}
 * @example
 *         min(4, 2) //=&gt; 2
 *         min(4, &apos;2&apos;) //=&gt; 2
 *         min(4, null) //=&gt; 0
 *         min(undefined, null) //=&gt; 0
 */
export const min = H.min;

/**
 * @param  {number} v
 * @returns {number}
 * @example
 *         absolute(2) //=&gt; 2
 *         absolute(-2) //=&gt; 2
 */
export const absolute = R.curry(v =&gt; Math.abs(v));

/**
 * Returns `[x, y]`.
 *
 *
 * @param  {any} x
 * @param  {any} y
 * @returns {Array}
 * @example
 */
export const makePair = R.curry((x, y) =&gt; [x, y]);

/**
 * Retrieves value at the specified path from a JSON object. &apos;*&apos; in the path is regarded as
 * a wildcard, meaning anything at this level will used to pick value from.
 *
 * @func
 * @param  {Array&lt;string&gt;} path
 * @param  {Object} input
 * @returns {any}
 * @example
 *      pickFrom([&apos;a&apos;,&apos;b&apos;,&apos;c&apos;], {&apos;a&apos;: {&apos;b&apos;: {&apos;c&apos;: 20}}}) //=&gt; 20
 *      pickFrom([&apos;a&apos;,&apos;*&apos;,&apos;x&apos;], {&apos;a&apos;: {&apos;b&apos;: {&apos;x&apos;: 20}, &apos;c&apos;: {&apos;x&apos;: 40}}}) //=&gt; [20, 40]
 */
export const pickFrom = R.memoizeWith((x, y) =&gt; R.toString([x, y]), R.curry(H.pickFrom));

/**
 * Filters key-value pairs from a JSON object when key matches the specified regular expression (or string).
 *
 * @func
 * @param  {string} path
 * @param  {Object} input
 * @returns {Object}
 * @example
 *      pickByRegex(&apos;abc&apos;, {&apos;abcd&apos;: {&apos;b&apos;: {&apos;c&apos;: 20}}, &apos;efg&apos;: {&apos;h&apos;: {&apos;i&apos;: 20}}) //=&gt; {&apos;b&apos;: {&apos;c&apos;: 20}}
 */
export const pickByRegex = R.memoizeWith(
  (x, y) =&gt; R.toString([x, y]),
  R.curry((text, data) =&gt;
    R.ifElse(
      R.always(isNothing(text)),
      R.always({}),
      R.pickBy((v, k) =&gt; R.test(new RegExp(text), k))
    )(data)
  )
);

/**
 * @param  {Function} xformer
 * @param  {Object|Array&lt;Object&gt;}  data
 * @returns {Object}
 */
export const mergeWithOp = R.memoizeWith(
  (x, y) =&gt; R.toString([x, y]),
  R.curry((xformer, data) =&gt;
    R.ifElse(
      H.typeMatches(&apos;array&apos;),
      R.pipe(
        R.reject(isNothing),
        R.reduce(R.mergeDeepWith(D.decodeAction(xformer)), {})
      ),
      R.pipe(
        R.pickBy(H.typeMatches(&apos;object&apos;)),
        R.values,
        R.reduce(R.mergeDeepWith(D.decodeAction(xformer)), {})
      )
    )(data)
  )
);

/**
 * Merges a list of JSON objects into a single JSON object by adding values having the same key; treats a non-number value as zero.
 *
 * @func
 * @param  {Array&lt;Object&gt;} data
 * @returns {Object}
 * @example
 *      mergeWithAdd([{ a: 1, b: 5 }, { a: 2 }, { a: 3 }]) //=&gt; { a: 6, b: 5 }
 */
export const mergeWithAdd = mergeWithOp(&apos;add&apos;);

/**
 * Merges a list of JSON objects into a single JSON object by subtracting values having the same key; treats a non-number value as zero.
 *
 * @func
 * @param  {Array&lt;Object&gt;} data
 * @returns {Object}
 * @example
 *      mergeWithSubtract([{ a: 1, b: 5 }, { a: 2 }, { a: 3 }]) //=&gt; { a: 2, b: 5 }
 */
export const mergeWithSubtract = mergeWithOp(&apos;subtract&apos;);

/**
 * Merges a list of JSON objects into a single JSON object by applying max to values having the same key; treats a non-number value as zero.
 *
 * @func
 * @param  {Array&lt;Object&gt;} data
 * @returns {Object}
 * @example
 *      mergeWithMax([{ a: 1, b: 5 }, { a: 2 }, { a: 3 }]) //=&gt; { a: 3, b: 5 }
 */
export const mergeWithMax = mergeWithOp(&apos;max&apos;);

/**
 * Merges a list of JSON objects into a single JSON object by applying min to values having the same key; treats a non-number value as zero.
 *
 * @func
 * @param  {Array&lt;Object&gt;} data
 * @returns {Object}
 * @example
 *      mergeWithMin([{ a: 2, b: 5 }, { a: 1 }, { a: 3 }]) //=&gt; { a: 1, b: 5 }
 */
export const mergeWithMin = mergeWithOp(&apos;min&apos;);

/**
 * Merges a list of JSON objects into a single JSON object by subtracting values having the same key; treats a non-number value as zero.
 *
 * @func
 * @param  {Array&lt;Object&gt;} data
 * @returns {Object}
 * @example
 *      mergeAll([{ a: 1, b: 5 }, { a: 2 }, { a: 3 }]) //=&gt; { a: 2, b: 5 }
 */
export const mergeAll = mergeWithOp(H.keepLatest);

/**
 * Applies iterative subtraction over consecutive values in a JSON object such that T[i] = T[i] - T[i-1]; first value is ignored in the result.
 *
 * @func
 * @param  {Array&lt;Object&gt;} data
 * @returns {Object}
 * @example
 *      differential({ a: 1, b: 2, c: 3 }) //=&gt; { b: 1, c: 1 }
 */
export const differential = R.memoizeWith(
  R.toString,
  R.curry(data =&gt; {
    const calculator = R.pipe(
      R.toPairs,
      R.reject(x =&gt; H.isJunk(x[1])),
      R.sortBy(R.prop(0)),
      R.aperture(2),
      R.map(([prev, next]) =&gt; [next[0], R.subtract(...R.pluck(1, [next, prev]))]),
      R.map(
        R.over(
          R.lensIndex(1),
          R.pipe(
            H.defaultToZero,
            R.max(0)
          )
        )
      ),
      R.fromPairs
    );

    return R.cond([
      [H.typeMatches(&apos;object&apos;), calculator],
      [
        H.typeMatches(&apos;array&apos;),
        R.pipe(
          calculator,
          R.values
        )
      ]
    ])(data);
  })
);

/**
 * Recieves an array or object, adds all the values and return a single number. All non-number values
 * are treated as zero.
 *
 * @func
 * @param  {Object|Array} data
 * @returns {number}
 * @example
 *      sumAll([1, 2, 3]) //=&gt; 6
 *      sumAll({a: 1, b: 2, c: 3}) //=&gt; 6
 */
export const sumAll = R.memoizeWith(
  R.toString,
  R.cond([
    [
      H.typeMatches(&apos;object&apos;),
      R.pipe(
        R.values,
        H.sumList
      )
    ],
    [H.typeMatches(&apos;array&apos;), H.sumList],
    [H.typeMatches(&apos;number&apos;), H.defaultToZero],
    [H.typeMatches(&apos;string&apos;), H.defaultToZero],
    [R.T, R.always(0)]
  ])
);

/**
 * Recieves an array or object and replaces each junky value with the provided fallback value.
 * A value is considered junk if it can not be converted to a valid number. A stringy number
 * is converted to number.
 *
 * @param  {number} value
 * @param  {Object|Array} data
 * @returns {number}
 * @example
 *      defaultAll(&apos;N/A&apos;, [1, NaN, &apos;3&apos;])) //=&gt; [1, &apos;N/A&apos;, 3]
 */
export const defaultAll = R.curry((value, data) =&gt; {
  return R.cond([
    [R.anyPass([H.typeMatches(&apos;array&apos;), H.typeMatches(&apos;object&apos;)]), R.map(H.defaultTo(value))],
    [R.T, H.defaultTo(value)]
  ])(data);
});

/**
 * Calculates percentages of used memory when given a list or JSON object containing percentages of free memory.
 *
 * @func
 * @param  {any} input
 * @returns {number}
 * @example
 *      getUsedMemory([0.1, 0.2, 0.3]) //=&gt; [90, 80, 70]
 */
export const getUsedMemory = R.cond([
  [H.typeMatches(&apos;array&apos;), R.map(H.getUsedMemoryForSingle)],
  [H.typeMatches(&apos;object&apos;), R.map(H.getUsedMemoryForSingle)],
  [R.T, H.getUsedMemoryForSingle]
]);

/**
 * Calculates average of values in a list or JSON object; ignores values that are not numbers.
 *
 * @func
 * @param  {any} data
 * @returns {number}
 * @example
 *      getAvg([1, 2, 3]) //=&gt; 2
 */
export const getAvg = R.memoizeWith(
  R.toString,
  R.cond([
    [H.typeMatches(&apos;array&apos;), H.getAverageForList],
    [
      H.typeMatches(&apos;object&apos;),
      R.pipe(
        R.values,
        H.getAverageForList
      )
    ],
    [R.T, H.defaultToZero]
  ])
);

/**
 * Execute a list of pipelines on provided data. A pipeline is an array of action descriptions.
 * An action can be described in form of a string or JSON.
 *
 * @func
 * @param  {Array} pipes
 * @returns {Array}
 * @example
 *      runAll([
 *        [&apos;pickFrom([&quot;alpha&quot;])&apos;, &apos;getAvg&apos;], // pipe 1
 *        [&apos;pickFrom([&quot;beta&quot;])&apos;, &apos;getAvg&apos;],  // pipe 2
 *      ], {
 *        alpha: { a1: 1, a2: 2, a3: 3 },
 *        beta: { b1: 11, b2: 22, b3: 33 },
 *      })
 *
 *      =&gt; [2, 22]
 */
export const runAll = R.memoizeWith(
  (x, y) =&gt; R.toString([x, y]),
  R.curry((pipes, data) =&gt; {
    return R.juxt(D.decodePipe(pipes))(data);
  })
);

/**
 * Divides values in a list or JSON object by the provided denominator.
 *
 * @param  {Array} pipes
 * @returns {Array}
 * @example
 *       getRate(10, {&apos;a&apos;: 20, &apos;b&apos;: 30}) // =&gt; {&apos;a&apos;: 2, &apos;b&apos;: 3}
 */
export const getRate = R.memoizeWith(
  (x, y) =&gt; R.toString([x, y]),
  R.curry((denominator, data) =&gt; {
    return R.cond([
      [
        R.anyPass([H.typeMatches(&apos;array&apos;), H.typeMatches(&apos;object&apos;)]),
        R.map(H.divide(R.__, denominator))
      ],
      [R.T, H.divide(R.__, denominator)]
    ])(data);
  })
);

/**
 * Takes an action and data as input and returns the result of performing that action on each value in the data.
 *
 * @param  {Array} action
 * @param  {Array|Object} data
 * @returns {Array|Object}
 * @example
 *       map([&apos;sumAll&apos;, &apos;getRate(100)&apos;], [[2, 4], [4, 6]]) //=&gt; [0.06, 0.1]
 */
export const map = R.curry((action, data) =&gt; {
  return R.map(D.decodeAction(action), data);
});

/**
 * Sort an Object or Array. Type can either be &apos;ascend&apos; or &apos;descend&apos;. When data is an array of
 * objects or arrays, key refers to the value with respect to which you want the data sorted. When data is an
 * object, key can either be `0` (sort by key) or `1` (sort by value); sorted object is returned as
 * a list of `[key, value]` pairs. When data is simply an array of numbers, key is ignored even if provided.
 *
 * @param  {string} type
 * @param  {string|number} key
 * @param  {any} data
 * @returns {_data}
 * @example
 *       map([&apos;sumAll&apos;, &apos;getRate(100)&apos;], [[2, 4], [4, 6]])
 */
const _sort = R.memoizeWith(
  (x, y, z) =&gt; R.toString([x, y, z]),
  R.curry((type, key, data) =&gt; {
    return R.cond([
      [
        H.typeMatches(&apos;array&apos;),
        R.cond([
          [R.always(H.typeMatches(&apos;object&apos;, R.head(data))), R.sort(R[type](R.prop(key)))],
          [R.always(H.typeMatches(&apos;array&apos;, R.head(data))), R.sort(R[type](R.prop(key)))],
          [
            R.always(H.typeMatches(&apos;number&apos;, R.head(data))),
            R.sort(type === &apos;ascend&apos; ? R.gt : R.lt)
          ],
          [R.always(H.typeMatches(&apos;string&apos;, R.head(data))), R.sort(type === &apos;ascend&apos; ? R.gt : R.lt)]
        ])
      ],
      [
        H.typeMatches(&apos;object&apos;),
        R.pipe(
          R.toPairs,
          R.sort(R[type](R.prop(R.clamp(0, 1, H.defaultToZero(key)))))
        )
      ]
    ])(data);
  })
);

/**
 * Sorts an array or object in ascending order. When data is an array of objects or arrays, key
 * refers to the value with respect to which you want the data sorted. When data is an object, key
 * can either be `0` (sort by key) or `1` (sort by value); sorted object is returned as a list
 * of `[key, value]` pairs. When data is simply an array of numbers, key is ignored even if provided.
 *
 * @param  {string|number} key
 * @returns {data}
 * @example
 *       sortAscending(null, [3, 2, 1]);    //=&gt; [1, 2, 3]
 *       sortAscending(1, [[1, 345], [2, 45], [3, 121]]);    //=&gt; [[2, 45], [3, 121], [1, 345]]
 *       sortAscending(0, { &apos;jkl&apos;: 345, &apos;efg&apos;: 121, &apos;uvx&apos;: 45 });    //=&gt; [[&apos;efg&apos;, 121], [&apos;jkl&apos;, 345], [&apos;uvx&apos;, 45]]
 *       sortAscending(1, { &apos;jkl&apos;: 345, &apos;efg&apos;: 121, &apos;uvx&apos;: 45 });    //=&gt; [[&apos;uvx&apos;, 45], [&apos;efg&apos;, 121], [&apos;jkl&apos;, 345]]
 */
export const sortAscending = _sort(&apos;ascend&apos;);

/**
 * Sorts an array or object in descending order. When data is an array of objects or arrays, key
 * refers to the value with respect to which you want the data sorted. When data is an object, key
 * can either be `0` (sort by key) or `1` (sort by value); sorted object is returned as a list
 * of `[key, value]` pairs. When data is simply an array of numbers, key is ignored even if provided.
 *
 * @param  {string|number} key
 * @returns {data}
 * @example
 *       sortDescending(null, [3, 2, 1]);    //=&gt; [3, 2, 1]
 *       sortDescending(1, [[1, 345], [2, 45], [3, 121]]);    //=&gt; [[1, 345], [3, 121], [2, 45]]
 *       sortDescending(0, { &apos;jkl&apos;: 345, &apos;efg&apos;: 121, &apos;uvx&apos;: 45 });    //=&gt; [[&apos;uvx&apos;, 45], [&apos;jkl&apos;, 345], [&apos;efg&apos;, 121]]
 *       sortDescending(1, { &apos;jkl&apos;: 345, &apos;efg&apos;: 121, &apos;uvx&apos;: 45 });    //=&gt; [[&apos;jkl&apos;, 345], [&apos;efg&apos;, 121], [&apos;uvx&apos;, 45]]
 */
export const sortDescending = _sort(&apos;descend&apos;);

/**
 * Removes values from an array or object by applying the provided predicate functions on
 * each value in an OR fashion. Additionally for an object, if a key is empty, it is removed
 * regardless of the value.
 *
 * @param  {Array} predicates
 * @param  {Array} data
 * @returns {Array}
 * @example
 *        cleanData([&apos;isNothing&apos;], [null, 1, 2, undefined, 3])
 *        //=&gt; [1, 2, 3]
 */
export const cleanData = R.memoizeWith(
  (x, y) =&gt; R.toString([x, y]),
  R.curry((predicates, data) =&gt; {
    return R.cond([
      [H.typeMatches(&apos;array&apos;), R.reject(R.anyPass(D.decodePipe(predicates)))],
      [
        H.typeMatches(&apos;object&apos;),
        R.pickBy((v, k) =&gt;
          R.and(H.isSomething(k), R.complement(R.anyPass(D.decodePipe(predicates)))(v))
        )
      ]
    ])(data);
  })
);

/**
 * Removes values from an array or object by applying provided predicate on keys or indices.
 *
 * @param  {Array} predicates
 * @param  {Object} data
 * @returns {Object}
 * @example
 *        cleanDataByKeys([&apos;isNothing&apos;], {&apos;a&apos;:1,&apos;b&apos;:2,&apos;&apos;:3})
 *        //=&gt; {a:1,b:2}
 */
export const cleanDataByKeys = R.memoizeWith(
  (x, y) =&gt; R.toString([x, y]),
  R.curry((predicates, data) =&gt; {
    return R.cond([
      [
        H.typeMatches(&apos;array&apos;),
        R.pipe(
          R.pickBy((v, k) =&gt;
            R.and(H.isSomething(k), R.complement(R.anyPass(D.decodePipe(predicates)))(k))
          ),
          R.values
        )
      ],
      [
        H.typeMatches(&apos;object&apos;),
        R.pickBy((v, k) =&gt;
          R.and(H.isSomething(k), R.complement(R.anyPass(D.decodePipe(predicates)))(k))
        )
      ]
    ])(data);
  })
);

/**
 * Takes top `x` items from a list and combines remaining by applying provided xformer.
 * Returns `[...topX, others]`.
 *
 * @param  {number} count
 * @param  {string|Object|Array} xformer
 * @param  {Array} data
 * @returns {Array}
 * @example
 *        takeTopAndCombineOthers(2, &apos;sumAll&apos;, [2, 3, 1, 2, 3])
 *        //=&gt; [2, 3, 6]
 *
 */
export const takeTopAndCombineOthers = R.memoizeWith(
  (x, y, z) =&gt; R.toString([x, y, z]),
  R.curry((x, xformer, data) =&gt; {
    return R.pipe(
      R.splitAt(x),
      ([topX, others]) =&gt; [...topX, D.decodeAction(xformer)(others)]
    )(data);
  })
);

/**
 * Takes top `x` pairs from a list of pairs and combines remaining pairs by adding values
 * on index `1` of each pair; a pair should be of form `[x: any, y: number]`. Returns `[topX, others]`.
 *
 * @param  {number} count
 * @param  {string|Object|Array} xformer
 * @param  {Array} data
 * @returns {Array}
 * @example
 *        takeTopPairsAndAddOthers(2, [[&apos;abs&apos;, 2], [&apos;fat&apos;, 3], [&apos;net&apos;, 1], [&apos;rip&apos;, 2], [&apos;dom&apos;, 3]])
 *        //=&gt; [[&apos;abs&apos;, 2], [&apos;fat&apos;, 3], [&apos;Others&apos;, 6]]
 */
export const takeTopPairsAndAddOthers = takeTopAndCombineOthers(
  R.__,
  [&apos;pickFrom([&quot;*&quot;, 1])&apos;, &apos;sumAll&apos;, &apos;makePair(&quot;Others&quot;)&apos;],
  R.__
);

/**
 * Find max value.
 *
 * @param  {any} value
 * @returns {number}
 * @example
 *        getMax([1, 2, 3, 4]) //=&gt; 4
 *        getMax({ a: 1, b: 2, c: 3 }) //=&gt; 3
 */
export const getMax = R.cond([
  [H.typeMatches(&apos;array&apos;), R.apply(Math.max)],
  [
    H.typeMatches(&apos;object&apos;),
    R.pipe(
      R.values,
      R.apply(Math.max)
    )
  ],
  [R.T, R.identity]
]);

/**
 * Check if any value in array or object satisfies condition.
 *
 * @param  {Array} predicates
 * @param  {any} data
 * @returns {boolean}
 * @example
 *        any(&apos;isLessThanEqualTo(0)&apos;, {a: -1, b: 2, c: -1}) //=&gt; true
 */
export const any = R.memoizeWith(
  (x, y) =&gt; R.toString([x, y]),
  R.curry((predicate, data) =&gt;
    R.cond([
      [H.typeMatches(&apos;array&apos;), R.any(D.decodeAction(predicate))],
      [
        H.typeMatches(&apos;object&apos;),
        R.pipe(
          R.values,
          R.any(D.decodeAction(predicate))
        )
      ],
      [R.T, D.decodeAction(predicate)]
    ])(data)
  )
);

/**
 * Check if all values in array or object satisfy condition. Returns false if data is anything other than an array
 * or object.
 *
 * @param  {Array} predicates
 * @param  {any} data
 * @returns {boolean}
 * @example
 *        all(&apos;isLessThanEqualTo(0)&apos;, {a: -1, b: 2, c: -1}) //=&gt; false
 */
export const all = R.memoizeWith(
  (x, y) =&gt; R.toString([x, y]),
  R.curry((predicate, data) =&gt;
    R.cond([
      [H.typeMatches(&apos;array&apos;), R.all(D.decodeAction(predicate))],
      [
        H.typeMatches(&apos;object&apos;),
        R.pipe(
          R.values,
          R.all(D.decodeAction(predicate))
        )
      ],
      [R.T, R.F]
    ])(data)
  )
);

/**
 * Check if data passes any conditions.
 *
 * @param  {Array} predicates
 * @param  {any} data
 * @returns {boolean}
 * @example
 *        anyPass([[&apos;sum&apos;, &apos;isEqualTo(0)&apos;]], {a: -1, b: 2, c: -1})
 */
export const anyPass = R.memoizeWith(
  (x, y) =&gt; R.toString([x, y]),
  R.curry((predicates, data) =&gt; R.anyPass(R.map(D.decodeAction, predicates))(data))
);

/**
 * Check if data passes all conditions.
 *
 * @param  {Array} predicates
 * @param  {any} data
 * @returns {boolean}
 * @example
 *        allPass([[&apos;sum&apos;, &apos;isEqualTo(0)&apos;]], {a: -1, b: 2, c: -1})
 */
export const allPass = R.memoizeWith(
  (x, y) =&gt; R.toString([x, y]),
  R.curry((predicates, data) =&gt; R.allPass(R.map(D.decodeAction, predicates))(data))
);
</code></pre>

</div>

<footer class="footer">
  Generated by <a href="https://esdoc.org">ESDoc<span data-ice="esdocVersion">(1.1.0)</span><img src="./image/esdoc-logo-mini-black.png"></a>
</footer>

<script src="script/search_index.js"></script>
<script src="script/search.js"></script>
<script src="script/pretty-print.js"></script>
<script src="script/inherited-summary.js"></script>
<script src="script/test-summary.js"></script>
<script src="script/inner-link.js"></script>
<script src="script/patch-for-local.js"></script>
</body>
</html>
